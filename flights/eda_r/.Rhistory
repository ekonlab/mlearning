area_km2
head(input_file)
head(u_flights)
one_flight = input_file %>%
filter(adshex=="10534350")
str(one_flight)
head(one_flight)
# Flight segments per flight
segments = unique(one_flight$flight_id)
str(segments)
segments
one_flight
init = min(one_flight$timestamp)
init = anytime(init)
end = max(one_flight$timestamp)
end = anytime(end)
dura = difftime(end,init,units="mins")
dura
area_km2
area_meters
area_km2 = area_meters / 1000
area_km2
head(input_file)
head(input_file)
sample_df = sample_n(input_file, 500)
str(sample_df)
dim(input_file)
dur_df = sample_df %>%
group_by(adshex) %>%
summarise(start = min(timestamp))
head(dur_df)
dur_df = sample_df %>%
group_by(adshex) %>%
summarise(start = min(timestamp)) %>%
mutate(start_2) = anytime(start)
dur_df = sample_df %>%
group_by(adshex) %>%
summarise(start = min(timestamp)) %>%
summarise(end = max(timestamp))
dur_df = sample_df %>%
group_by(adshex) %>%
summarise(start = min(timestamp),end = max(timestamp))
head(dur_df)
start_df = sample_df %>%
group_by(adshex) %>%
summarise(start = min(timestamp))
head(start_df)
head(input_file)
end_df = sample_df %>%
group_by(adshex) %>%
summarise(start = max(timestamp))
head(end_df)
start_df = sample_df %>%
group_by(adshex) %>%
summarize(start = min(timestamp))
head(start_df)
end_df = sample_df %>%
group_by(adshex) %>%
summarize(start = max(timestamp))
head(end_df)
head(start_df)
head(end_df)
str(input_file)
start_df = sample_df %>%
group_by(adshex) %>%
summarise(start = min(timestamp))
head(start_df)
end_df = sample_df %>%
group_by(adshex) %>%
summarise(end = max(timestamp))
head(end_df)
head(start_df)
head(end_df)
one_flight = input_file %>%
filter(adshex=="104cfff0")
str(one_flight)
head(one_flight)
head(one_flight)
segments = unique(one_flight$flight_id)
str(segments)
segments
init = min(one_flight$timestamp)
init
end = max(one_flight$timestamp)
end
one_flight
start_df = sample_df %>%
group_by(adshex) %>%
summarise(start = head(timestamp,1))
head(start_df)
end_df = sample_df %>%
group_by(adshex) %>%
summarise(end = tail(timestamp,1))
end_df
knitr::opts_chunk$set(echo = TRUE)
library(rjson)
library(dplyr)
library(tidyr)
library(ggmap)
library(ggplot2)
library(lubridate)
library(anytime)
library(sp)
library(tmaptools)
library(SpatialEpi)
library(Imap)
setwd("/Users/albertogonzalez/Documents/GitHub/mlearning/flights/eda_r")
list.files()
input_file =read.csv(file = "flights_output_take_one.csv")
head(input_file)
head(input_file)
sample_df = sample_n(input_file, 500)
str(sample_df)
dura_df = sample_df %>%
group_by(adshex) %>%
summarize(min_time = min(timestamp),max_time = max(timestamp))
head(dura_df)
head(dura_df)
one_flight = input_file %>%
filter(adshex=="104cfff0")
# Max and min timestamp
init = min(one_flight$timestamp)
one_flight
init
end = max(one_flight$timestamp)
end
head(one_flight)
head(one_flight)
table(one_flight$flight_id)
# Flight segments per flight
segments = as.data.frame(tabble(one_flight$flight_id))
# Flight segments per flight
segments = as.data.frame(tbble(one_flight$flight_id))
# Flight segments per flight
segments = as.data.frame(table(one_flight$flight_id))
str(segments)
head(segments)
head(segments)
segments = as.data.frame(table(one_flight$flight_id)) %>%
arrange(Freq) %>% head
segments
segments = as.data.frame(table(one_flight$flight_id)) %>%
arrange(desc(Freq)) %>%
head
segments
head(u_flights)
one_flight = input_file %>%
filter(adshex=="10542b98")
str(one_flight)
head(one_flight)
# Flight segments per flight
segments = as.data.frame(table(one_flight$flight_id)) %>%
arrange(desc(Freq)) %>%
head
segments
one_flight
segments
one_flight = input_file %>%
filter(adshex=="10534350")
segments = as.data.frame(table(one_flight$flight_id)) %>%
arrange(desc(Freq)) %>%
head
segments
segments
one_flight
segment_per_aircraft = input_file %>%
group_by(adshex,flight_id) %>%
summarise(length(flight_id))
segment_per_aircraft
segment_per_aircraft
se = as.data.frame(segment_per_aircraft)
head(se,20)
segment_per_aircraft = input_file %>%
group_by(adshex,flight_id) %>%
summarise(n = n())
se = as.data.frame(segment_per_aircraft)
head(se,20)
bbox
area_meters
area_km2
head(coords)
# Calculate steer: change in compass from previous transponder
# Calculated over track
head(one_flight)
head(one_flight)
head(one_flight)
steer = diff(one_flight$track)
head(steer,10)
head(steer,10)
str(sample_df)
dura_df = sample_df %>%
group_by(adshex) %>%
summarize(min_time = min(timestamp),max_time = max(timestamp))
head(dura_df)
knitr::opts_chunk$set(echo = TRUE)
library(rjson)
library(dplyr)
library(tidyr)
library(ggmap)
library(ggplot2)
library(lubridate)
library(anytime)
library(sp)
library(tmaptools)
library(SpatialEpi)
library(Imap)
setwd("/Users/albertogonzalez/Documents/GitHub/mlearning/flights/eda_r")
list.files()
input_file =read.csv(file = "flights_output_take_one.csv")
head(input_file)
head(input_file)
dim(input_file)
u = unique(input_file$adshex)
length(u)
setwd("/Users/albertogonzalez/Documents/GitHub/mlearning/flights/eda_r")
list.files()
# Load data (substitute this by the random 500 files from Lucas DB)
input_file =read.csv(file = "flights_output_take_one.csv")
head(input_file)
# Count number of different aircrafts
n_crafts = length(uniqe(input_file$adshex))
# Count number of different aircrafts
n_crafts = length(uniue(input_file$adshex))
# Count number of different aircrafts
n_crafts = length(unique(input_file$adshex))
n_crafts
one_flight = input_file %>%
filter(adshex=="10534350")
str(one_flight)
head(one_flight)
# Duration of that flight
init = min(one_flight$timestamp)
init = anytime(init)
end = max(one_flight$timestamp)
end = anytime(end)
dura = difftime(end,init,units="mins")
dura
init
end
dura
end - init
one_flight
# Bounding box of that flight
xy <- one_flight[,c(3,4)]
head(xy)
min_coord = head(xy,1)
max_coord = tail(xy,1)
min_coord
max_coord
area_meters = gdist(min_coord$lng,min_coord$lat,max_coord$lng,max_coord$lat, units = "m", a = 6378137.0, b = 6356752.3142, verbose = FALSE)
area_km2 = area_meters / 1000
area_km2
steer = diff(one_flight$track)
head(steer,10)
# Add one flight calculations
one_flight$duration = dura
head(one_flight)
one_flight$box = area_km2
head(one_flight)
one_flight$box_km2 = area_km2
head(one_flight)
one_flight = input_file %>%
filter(adshex=="10534350")
str(one_flight)
head(one_flight)
init = min(one_flight$timestamp)
init = anytime(init)
end = max(one_flight$timestamp)
end = anytime(end)
dura = difftime(end,init,units="mins")
dura
# Bounding box of that flight
xy <- one_flight[,c(3,4)]
min_coord = head(xy,1)
max_coord = tail(xy,1)
area_meters = gdist(min_coord$lng,min_coord$lat,max_coord$lng,max_coord$lat, units = "m", a = 6378137.0, b = 6356752.3142, verbose = FALSE)
area_km2 = area_meters / 1000
area_km2
# Calculate steer: change in compass from previous transponder
# Calculated over track
head(one_flight)
steer = diff(one_flight$track)
head(steer,10)
# Add one flight calculations
one_flight$duration = dura
one_flight$box_km2 = area_km2
steer
length(steer)
length(one_flight)
one_flight
dim(one_flight)
str(steer)
# Add first zero index to steer
steer_2 = rbind(0,steer)
steer_2
# Add first zero index to steer
steer_2 = paste(0,steer)
steer_2
# Add first zero index to steer
steer_2 = cbind(0,steer)
steer_2
# Add first zero index to steer
steer_2 = merge(0,steer)
steer_2
# Add first zero index to steer
steer_2 = data.frame(0,steer)
steer_2
head(steer,10)
steer
steer = as.data.frame(steer)
head(steer,10)
steer
# Add first zero index to steer
steer_2 = rbind(0,steer)
steer_2
one_flight
one_flight$steer = ster_2
one_flight$steer = steer_2
one_flight
foo = function(flight_df){
# Duration of that flight
init = min(flight_df$timestamp)
init = anytime(init)
end = max(flight_df$timestamp)
end = anytime(end)
dura = difftime(end,init,units="mins")
flight_df$duration = dura
flight_df
}
t = foo(one_flight)
t
head(input_file)
one_flight = input_file %>%
filter(adshex=="1053a509")
one_flight
t = foo(one_flight)
t
one_flight = input_file %>%
filter(adshex=="10542b98")
one_flight
flights_rows = as.data.frame(table(input_file$adshex))
head(flights_rows)
one_flight = input_file %>%
filter(adshex=="105348ce")
one_flight
t = foo(one_flight)
t
foo = function(flight_df){
# Duration of that flight
init = min(flight_df$timestamp)
init = anytime(init)
end = max(flight_df$timestamp)
end = anytime(end)
dura = difftime(end,init,units="mins")
flight_df$duration = dura
# Bounding box of that flight
xy <- flight_df[,c(3,4)]
min_coord = head(xy,1)
max_coord = tail(xy,1)
area_meters = gdist(min_coord$lng,min_coord$lat,max_coord$lng,max_coord$lat, units = "m", a = 6378137.0, b = 6356752.3142, verbose = FALSE)
area_km2 = area_meters / 1000
flight_df$box_km2 = area_km2
}
flights_rows = as.data.frame(table(input_file$adshex))
head(flights_rows)
one_flight = input_file %>%
filter(adshex=="105348ce")
one_flight
t = foo(one_flight)
t
foo = function(flight_df){
# Duration of that flight
init = min(flight_df$timestamp)
init = anytime(init)
end = max(flight_df$timestamp)
end = anytime(end)
dura = difftime(end,init,units="mins")
flight_df$duration = dura
# Bounding box of that flight
xy <- flight_df[,c(3,4)]
min_coord = head(xy,1)
max_coord = tail(xy,1)
area_meters = gdist(min_coord$lng,min_coord$lat,max_coord$lng,max_coord$lat, units = "m", a = 6378137.0, b = 6356752.3142, verbose = FALSE)
area_km2 = area_meters / 1000
flight_df$box_km2 = area_km2
flight_df
}
one_flight = input_file %>%
filter(adshex=="105348ce")
one_flight
t = foo(one_flight)
t
foo = function(flight_df){
# Duration of that flight
init = min(flight_df$timestamp)
init = anytime(init)
end = max(flight_df$timestamp)
end = anytime(end)
dura = difftime(end,init,units="mins")
flight_df$duration = dura
# Bounding box of that flight
xy <- flight_df[,c(3,4)]
min_coord = head(xy,1)
max_coord = tail(xy,1)
area_meters = gdist(min_coord$lng,min_coord$lat,max_coord$lng,max_coord$lat, units = "m", a = 6378137.0, b = 6356752.3142, verbose = FALSE)
area_km2 = area_meters / 1000
flight_df$box_km2 = area_km2
# Calculate steer: change in compass from previous transponder
steer = diff(flight_df$track)
steer = as.data.frame(steer)
steer_2 = rbind(0,steer)
flight_df$steer = steer_2
flight_df
}
flights_rows = as.data.frame(table(input_file$adshex))
head(flights_rows)
one_flight = input_file %>%
filter(adshex=="105348ce")
t = foo(one_flight)
t
one_flight = input_file %>%
filter(adshex=="10534343")
t = foo(one_flight)
t
df2 = input_file %>%
group_by(adshex)
head(df2)
df2 = input_file %>%
group_by(adshex) %>%
foo(df2$adshex)
df2 = input_file %>%
group_by(adshex) %>%
foo()
head(df2)
df2 = input_file %>%
group_by(adshex) %>%
foo(adshex)
Q
df2 = input_file %>%
group_by(adshex) %>%
do(data.frame(val=foo(.)))
head(df2)
df2 = input_file %>%
group_by(adshex) %>%
do.call(foo)
df2 = input_file %>%
group_by(adshex) %>%
do.call(foo,input_file$adshex)
df3 = do.call(foo,df2)
foo = function(flight_df){
# Duration of that flight
init = min(flight_df$timestamp)
init = anytime(init)
end = max(flight_df$timestamp)
end = anytime(end)
dura = difftime(end,init,units="mins")
flight_df$duration = dura
flight_df
}
one_flight = input_file %>%
filter(adshex=="10534343")
t = foo(one_flight)
t
df2 = input_file %>%
group_by(adshex) %>%
mutate(durat = foo(.))
df2 = input_file %>%
group_by(adshex) %>%
mutate(durat = foo)
df2 = input_file %>%
group_by(adshex) %>%
mutate(durat = foo(flight_df))
df2 = input_file %>%
group_by(adshex) %>%
mutate(durat = foo(adshex))
foo = function(flight_df){
# Duration of that flight
init = min(flight_df$timestamp)
init = anytime(init)
end = max(flight_df$timestamp)
end = anytime(end)
dura = difftime(end,init,units="mins")
flight_df$duration = dura
flight_df
# Bounding box of that flight
xy <- flight_df[,c(3,4)]
min_coord = head(xy,1)
max_coord = tail(xy,1)
area_meters = gdist(min_coord$lng,min_coord$lat,max_coord$lng,max_coord$lat, units = "m", a = 6378137.0, b = 6356752.3142, verbose = FALSE)
area_km2 = area_meters / 1000
flight_df$box_km2 = area_km2
# Calculate steer: change in compass from previous transponder
steer = diff(flight_df$track)
steer = as.data.frame(steer)
steer_2 = rbind(0,steer)
flight_df$steer = steer_2
flight_df
}
one_flight = input_file %>%
filter(adshex=="10534343")
t = foo(one_flight)
t
head(flights_rows)
one_flight = input_file %>%
filter(adshex=="10534350")
t = foo(one_flight)
t
df2 = input_file %>%
group_by(adshex) %>%
do(foo(.))
head(df2)
library(plyr)
